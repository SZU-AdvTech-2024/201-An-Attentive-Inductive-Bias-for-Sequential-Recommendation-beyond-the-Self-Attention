2024-12-03 20:33:01,241 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='BERT4Rec_LastFM', num_items=10, num_users=1091, lr=0.001, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='BERT4Rec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, mask_ratio=0.2, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/BERT4Rec_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2024-12-03 20:33:01,251 - BERT4RecModel(
  (item_embeddings): Embedding(3648, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
      (1): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
    )
  )
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
)
2024-12-03 20:33:02,641 - Total Parameters: 336768
2024-12-03 20:33:04,596 - {'epoch': 0, 'rec_loss': '7.9718'}
2024-12-03 20:33:04,874 - {'Epoch': 0, 'HR@5': '0.0202', 'NDCG@5': '0.0119', 'HR@10': '0.0367', 'NDCG@10': '0.0173', 'HR@20': '0.0560', 'NDCG@20': '0.0221'}
2024-12-03 20:33:04,875 - Validation score increased.  Saving model ...
2024-12-03 20:33:06,502 - {'epoch': 1, 'rec_loss': '7.7292'}
2024-12-03 20:33:06,791 - {'Epoch': 1, 'HR@5': '0.0239', 'NDCG@5': '0.0146', 'HR@10': '0.0330', 'NDCG@10': '0.0175', 'HR@20': '0.0523', 'NDCG@20': '0.0224'}
2024-12-03 20:33:06,792 - Validation score increased.  Saving model ...
2024-12-03 20:33:08,356 - {'epoch': 2, 'rec_loss': '7.6446'}
2024-12-03 20:33:08,635 - {'Epoch': 2, 'HR@5': '0.0266', 'NDCG@5': '0.0163', 'HR@10': '0.0404', 'NDCG@10': '0.0206', 'HR@20': '0.0642', 'NDCG@20': '0.0264'}
2024-12-03 20:33:08,635 - Validation score increased.  Saving model ...
2024-12-03 20:33:10,205 - {'epoch': 3, 'rec_loss': '7.5633'}
2024-12-03 20:33:10,493 - {'Epoch': 3, 'HR@5': '0.0266', 'NDCG@5': '0.0167', 'HR@10': '0.0468', 'NDCG@10': '0.0229', 'HR@20': '0.0771', 'NDCG@20': '0.0306'}
2024-12-03 20:33:10,494 - Validation score increased.  Saving model ...
2024-12-03 20:33:12,121 - {'epoch': 4, 'rec_loss': '7.4988'}
2024-12-03 20:33:12,403 - {'Epoch': 4, 'HR@5': '0.0266', 'NDCG@5': '0.0165', 'HR@10': '0.0514', 'NDCG@10': '0.0244', 'HR@20': '0.0826', 'NDCG@20': '0.0322'}
2024-12-03 20:33:12,404 - Validation score increased.  Saving model ...
2024-12-03 20:33:13,992 - {'epoch': 5, 'rec_loss': '7.4425'}
2024-12-03 20:33:14,270 - {'Epoch': 5, 'HR@5': '0.0321', 'NDCG@5': '0.0189', 'HR@10': '0.0523', 'NDCG@10': '0.0256', 'HR@20': '0.0807', 'NDCG@20': '0.0329'}
2024-12-03 20:33:14,271 - Validation score increased.  Saving model ...
2024-12-03 20:33:15,843 - {'epoch': 6, 'rec_loss': '7.3874'}
2024-12-03 20:33:16,118 - {'Epoch': 6, 'HR@5': '0.0339', 'NDCG@5': '0.0208', 'HR@10': '0.0477', 'NDCG@10': '0.0252', 'HR@20': '0.0771', 'NDCG@20': '0.0327'}
2024-12-03 20:33:16,119 - EarlyStopping counter: 1 out of 10
2024-12-03 20:33:17,671 - {'epoch': 7, 'rec_loss': '7.3315'}
2024-12-03 20:33:17,952 - {'Epoch': 7, 'HR@5': '0.0284', 'NDCG@5': '0.0168', 'HR@10': '0.0394', 'NDCG@10': '0.0204', 'HR@20': '0.0688', 'NDCG@20': '0.0278'}
2024-12-03 20:33:17,952 - EarlyStopping counter: 2 out of 10
2024-12-03 20:33:19,534 - {'epoch': 8, 'rec_loss': '7.2738'}
2024-12-03 20:33:19,813 - {'Epoch': 8, 'HR@5': '0.0358', 'NDCG@5': '0.0241', 'HR@10': '0.0505', 'NDCG@10': '0.0289', 'HR@20': '0.0688', 'NDCG@20': '0.0334'}
2024-12-03 20:33:19,814 - Validation score increased.  Saving model ...
2024-12-03 20:33:21,386 - {'epoch': 9, 'rec_loss': '7.2029'}
2024-12-03 20:33:21,664 - {'Epoch': 9, 'HR@5': '0.0358', 'NDCG@5': '0.0222', 'HR@10': '0.0578', 'NDCG@10': '0.0291', 'HR@20': '0.0853', 'NDCG@20': '0.0361'}
2024-12-03 20:33:21,664 - Validation score increased.  Saving model ...
2024-12-03 20:33:23,246 - {'epoch': 10, 'rec_loss': '7.1540'}
2024-12-03 20:33:23,523 - {'Epoch': 10, 'HR@5': '0.0367', 'NDCG@5': '0.0234', 'HR@10': '0.0606', 'NDCG@10': '0.0309', 'HR@20': '0.0890', 'NDCG@20': '0.0380'}
2024-12-03 20:33:23,524 - Validation score increased.  Saving model ...
2024-12-03 20:33:25,194 - {'epoch': 11, 'rec_loss': '7.0890'}
2024-12-03 20:33:25,488 - {'Epoch': 11, 'HR@5': '0.0284', 'NDCG@5': '0.0175', 'HR@10': '0.0541', 'NDCG@10': '0.0257', 'HR@20': '0.0872', 'NDCG@20': '0.0341'}
2024-12-03 20:33:25,489 - EarlyStopping counter: 1 out of 10
2024-12-03 20:33:27,135 - {'epoch': 12, 'rec_loss': '7.0483'}
2024-12-03 20:33:27,423 - {'Epoch': 12, 'HR@5': '0.0376', 'NDCG@5': '0.0232', 'HR@10': '0.0651', 'NDCG@10': '0.0321', 'HR@20': '0.0927', 'NDCG@20': '0.0391'}
2024-12-03 20:33:27,424 - Validation score increased.  Saving model ...
2024-12-03 20:33:29,058 - {'epoch': 13, 'rec_loss': '7.0150'}
2024-12-03 20:33:29,352 - {'Epoch': 13, 'HR@5': '0.0413', 'NDCG@5': '0.0258', 'HR@10': '0.0651', 'NDCG@10': '0.0332', 'HR@20': '0.0991', 'NDCG@20': '0.0416'}
2024-12-03 20:33:29,353 - Validation score increased.  Saving model ...
2024-12-03 20:33:30,997 - {'epoch': 14, 'rec_loss': '6.9818'}
2024-12-03 20:33:31,281 - {'Epoch': 14, 'HR@5': '0.0367', 'NDCG@5': '0.0261', 'HR@10': '0.0560', 'NDCG@10': '0.0322', 'HR@20': '0.0817', 'NDCG@20': '0.0386'}
2024-12-03 20:33:31,281 - EarlyStopping counter: 1 out of 10
2024-12-03 20:33:32,894 - {'epoch': 15, 'rec_loss': '6.9389'}
2024-12-03 20:33:33,182 - {'Epoch': 15, 'HR@5': '0.0330', 'NDCG@5': '0.0225', 'HR@10': '0.0550', 'NDCG@10': '0.0296', 'HR@20': '0.0881', 'NDCG@20': '0.0378'}
2024-12-03 20:33:33,183 - EarlyStopping counter: 2 out of 10
2024-12-03 20:33:34,830 - {'epoch': 16, 'rec_loss': '6.9089'}
2024-12-03 20:33:35,108 - {'Epoch': 16, 'HR@5': '0.0394', 'NDCG@5': '0.0249', 'HR@10': '0.0578', 'NDCG@10': '0.0307', 'HR@20': '0.0835', 'NDCG@20': '0.0372'}
2024-12-03 20:33:35,109 - EarlyStopping counter: 3 out of 10
2024-12-03 20:33:36,744 - {'epoch': 17, 'rec_loss': '6.8731'}
2024-12-03 20:33:37,025 - {'Epoch': 17, 'HR@5': '0.0440', 'NDCG@5': '0.0285', 'HR@10': '0.0642', 'NDCG@10': '0.0351', 'HR@20': '0.0908', 'NDCG@20': '0.0418'}
2024-12-03 20:33:37,026 - Validation score increased.  Saving model ...
2024-12-03 20:33:38,714 - {'epoch': 18, 'rec_loss': '6.8433'}
2024-12-03 20:33:39,002 - {'Epoch': 18, 'HR@5': '0.0385', 'NDCG@5': '0.0258', 'HR@10': '0.0651', 'NDCG@10': '0.0345', 'HR@20': '0.0917', 'NDCG@20': '0.0412'}
2024-12-03 20:33:39,002 - EarlyStopping counter: 1 out of 10
2024-12-03 20:33:40,622 - {'epoch': 19, 'rec_loss': '6.8150'}
2024-12-03 20:33:40,911 - {'Epoch': 19, 'HR@5': '0.0413', 'NDCG@5': '0.0265', 'HR@10': '0.0651', 'NDCG@10': '0.0340', 'HR@20': '0.0908', 'NDCG@20': '0.0404'}
2024-12-03 20:33:40,912 - EarlyStopping counter: 2 out of 10
2024-12-03 20:33:42,512 - {'epoch': 20, 'rec_loss': '6.7835'}
2024-12-03 20:33:42,800 - {'Epoch': 20, 'HR@5': '0.0431', 'NDCG@5': '0.0286', 'HR@10': '0.0596', 'NDCG@10': '0.0338', 'HR@20': '0.0991', 'NDCG@20': '0.0438'}
2024-12-03 20:33:42,800 - Validation score increased.  Saving model ...
2024-12-03 20:33:44,396 - {'epoch': 21, 'rec_loss': '6.7472'}
2024-12-03 20:33:44,683 - {'Epoch': 21, 'HR@5': '0.0404', 'NDCG@5': '0.0267', 'HR@10': '0.0624', 'NDCG@10': '0.0338', 'HR@20': '0.1018', 'NDCG@20': '0.0438'}
2024-12-03 20:33:44,683 - Validation score increased.  Saving model ...
2024-12-03 20:33:46,327 - {'epoch': 22, 'rec_loss': '6.7206'}
2024-12-03 20:33:46,622 - {'Epoch': 22, 'HR@5': '0.0459', 'NDCG@5': '0.0291', 'HR@10': '0.0624', 'NDCG@10': '0.0342', 'HR@20': '0.0945', 'NDCG@20': '0.0423'}
2024-12-03 20:33:46,622 - EarlyStopping counter: 1 out of 10
2024-12-03 20:33:48,252 - {'epoch': 23, 'rec_loss': '6.6884'}
2024-12-03 20:33:48,550 - {'Epoch': 23, 'HR@5': '0.0431', 'NDCG@5': '0.0256', 'HR@10': '0.0679', 'NDCG@10': '0.0337', 'HR@20': '0.0972', 'NDCG@20': '0.0411'}
2024-12-03 20:33:48,550 - EarlyStopping counter: 2 out of 10
2024-12-03 20:33:50,121 - {'epoch': 24, 'rec_loss': '6.6642'}
2024-12-03 20:33:50,397 - {'Epoch': 24, 'HR@5': '0.0431', 'NDCG@5': '0.0280', 'HR@10': '0.0725', 'NDCG@10': '0.0372', 'HR@20': '0.1064', 'NDCG@20': '0.0458'}
2024-12-03 20:33:50,397 - Validation score increased.  Saving model ...
2024-12-03 20:33:52,037 - {'epoch': 25, 'rec_loss': '6.6358'}
2024-12-03 20:33:52,319 - {'Epoch': 25, 'HR@5': '0.0413', 'NDCG@5': '0.0261', 'HR@10': '0.0651', 'NDCG@10': '0.0337', 'HR@20': '0.0972', 'NDCG@20': '0.0418'}
2024-12-03 20:33:52,320 - EarlyStopping counter: 1 out of 10
2024-12-03 20:33:53,947 - {'epoch': 26, 'rec_loss': '6.6221'}
2024-12-03 20:33:54,231 - {'Epoch': 26, 'HR@5': '0.0505', 'NDCG@5': '0.0327', 'HR@10': '0.0734', 'NDCG@10': '0.0401', 'HR@20': '0.1037', 'NDCG@20': '0.0479'}
2024-12-03 20:33:54,232 - Validation score increased.  Saving model ...
2024-12-03 20:33:55,884 - {'epoch': 27, 'rec_loss': '6.6006'}
2024-12-03 20:33:56,173 - {'Epoch': 27, 'HR@5': '0.0440', 'NDCG@5': '0.0300', 'HR@10': '0.0688', 'NDCG@10': '0.0378', 'HR@20': '0.1018', 'NDCG@20': '0.0462'}
2024-12-03 20:33:56,173 - EarlyStopping counter: 1 out of 10
2024-12-03 20:33:57,819 - {'epoch': 28, 'rec_loss': '6.5790'}
2024-12-03 20:33:58,095 - {'Epoch': 28, 'HR@5': '0.0422', 'NDCG@5': '0.0267', 'HR@10': '0.0734', 'NDCG@10': '0.0368', 'HR@20': '0.1028', 'NDCG@20': '0.0443'}
2024-12-03 20:33:58,095 - EarlyStopping counter: 2 out of 10
2024-12-03 20:33:59,705 - {'epoch': 29, 'rec_loss': '6.5608'}
2024-12-03 20:33:59,994 - {'Epoch': 29, 'HR@5': '0.0385', 'NDCG@5': '0.0244', 'HR@10': '0.0642', 'NDCG@10': '0.0327', 'HR@20': '0.1055', 'NDCG@20': '0.0431'}
2024-12-03 20:33:59,994 - EarlyStopping counter: 3 out of 10
2024-12-03 20:34:01,647 - {'epoch': 30, 'rec_loss': '6.5417'}
2024-12-03 20:34:01,935 - {'Epoch': 30, 'HR@5': '0.0404', 'NDCG@5': '0.0230', 'HR@10': '0.0697', 'NDCG@10': '0.0325', 'HR@20': '0.1064', 'NDCG@20': '0.0416'}
2024-12-03 20:34:01,935 - EarlyStopping counter: 4 out of 10
2024-12-03 20:34:03,550 - {'epoch': 31, 'rec_loss': '6.5219'}
2024-12-03 20:34:03,835 - {'Epoch': 31, 'HR@5': '0.0450', 'NDCG@5': '0.0284', 'HR@10': '0.0716', 'NDCG@10': '0.0367', 'HR@20': '0.1037', 'NDCG@20': '0.0449'}
2024-12-03 20:34:03,835 - EarlyStopping counter: 5 out of 10
2024-12-03 20:34:05,421 - {'epoch': 32, 'rec_loss': '6.5129'}
2024-12-03 20:34:05,702 - {'Epoch': 32, 'HR@5': '0.0394', 'NDCG@5': '0.0270', 'HR@10': '0.0679', 'NDCG@10': '0.0363', 'HR@20': '0.1000', 'NDCG@20': '0.0444'}
2024-12-03 20:34:05,703 - EarlyStopping counter: 6 out of 10
2024-12-03 20:34:07,242 - {'epoch': 33, 'rec_loss': '6.4990'}
2024-12-03 20:34:07,532 - {'Epoch': 33, 'HR@5': '0.0450', 'NDCG@5': '0.0280', 'HR@10': '0.0725', 'NDCG@10': '0.0368', 'HR@20': '0.1083', 'NDCG@20': '0.0458'}
2024-12-03 20:34:07,532 - EarlyStopping counter: 7 out of 10
2024-12-03 20:34:09,131 - {'epoch': 34, 'rec_loss': '6.4724'}
2024-12-03 20:34:09,418 - {'Epoch': 34, 'HR@5': '0.0394', 'NDCG@5': '0.0239', 'HR@10': '0.0697', 'NDCG@10': '0.0337', 'HR@20': '0.1037', 'NDCG@20': '0.0422'}
2024-12-03 20:34:09,419 - EarlyStopping counter: 8 out of 10
2024-12-03 20:34:11,070 - {'epoch': 35, 'rec_loss': '6.4699'}
2024-12-03 20:34:11,365 - {'Epoch': 35, 'HR@5': '0.0422', 'NDCG@5': '0.0284', 'HR@10': '0.0734', 'NDCG@10': '0.0386', 'HR@20': '0.1128', 'NDCG@20': '0.0484'}
2024-12-03 20:34:11,366 - Validation score increased.  Saving model ...
2024-12-03 20:34:13,014 - {'epoch': 36, 'rec_loss': '6.4462'}
2024-12-03 20:34:13,307 - {'Epoch': 36, 'HR@5': '0.0321', 'NDCG@5': '0.0209', 'HR@10': '0.0661', 'NDCG@10': '0.0316', 'HR@20': '0.1119', 'NDCG@20': '0.0432'}
2024-12-03 20:34:13,308 - EarlyStopping counter: 1 out of 10
2024-12-03 20:34:14,952 - {'epoch': 37, 'rec_loss': '6.4406'}
2024-12-03 20:34:15,248 - {'Epoch': 37, 'HR@5': '0.0376', 'NDCG@5': '0.0238', 'HR@10': '0.0651', 'NDCG@10': '0.0325', 'HR@20': '0.1092', 'NDCG@20': '0.0436'}
2024-12-03 20:34:15,249 - EarlyStopping counter: 2 out of 10
2024-12-03 20:34:16,869 - {'epoch': 38, 'rec_loss': '6.4129'}
2024-12-03 20:34:17,151 - {'Epoch': 38, 'HR@5': '0.0404', 'NDCG@5': '0.0262', 'HR@10': '0.0771', 'NDCG@10': '0.0380', 'HR@20': '0.1037', 'NDCG@20': '0.0447'}
2024-12-03 20:34:17,151 - EarlyStopping counter: 3 out of 10
2024-12-03 20:34:18,812 - {'epoch': 39, 'rec_loss': '6.4006'}
2024-12-03 20:34:19,091 - {'Epoch': 39, 'HR@5': '0.0422', 'NDCG@5': '0.0291', 'HR@10': '0.0725', 'NDCG@10': '0.0390', 'HR@20': '0.1055', 'NDCG@20': '0.0474'}
2024-12-03 20:34:19,092 - EarlyStopping counter: 4 out of 10
2024-12-03 20:34:20,687 - {'epoch': 40, 'rec_loss': '6.3889'}
2024-12-03 20:34:20,973 - {'Epoch': 40, 'HR@5': '0.0477', 'NDCG@5': '0.0299', 'HR@10': '0.0752', 'NDCG@10': '0.0388', 'HR@20': '0.1083', 'NDCG@20': '0.0470'}
2024-12-03 20:34:20,973 - EarlyStopping counter: 5 out of 10
2024-12-03 20:34:22,581 - {'epoch': 41, 'rec_loss': '6.3808'}
2024-12-03 20:34:22,862 - {'Epoch': 41, 'HR@5': '0.0431', 'NDCG@5': '0.0283', 'HR@10': '0.0624', 'NDCG@10': '0.0345', 'HR@20': '0.1073', 'NDCG@20': '0.0458'}
2024-12-03 20:34:22,862 - EarlyStopping counter: 6 out of 10
2024-12-03 20:34:24,495 - {'epoch': 42, 'rec_loss': '6.3548'}
2024-12-03 20:34:24,793 - {'Epoch': 42, 'HR@5': '0.0321', 'NDCG@5': '0.0230', 'HR@10': '0.0633', 'NDCG@10': '0.0331', 'HR@20': '0.1083', 'NDCG@20': '0.0445'}
2024-12-03 20:34:24,794 - EarlyStopping counter: 7 out of 10
2024-12-03 20:34:26,390 - {'epoch': 43, 'rec_loss': '6.3560'}
2024-12-03 20:34:26,676 - {'Epoch': 43, 'HR@5': '0.0349', 'NDCG@5': '0.0228', 'HR@10': '0.0688', 'NDCG@10': '0.0338', 'HR@20': '0.0954', 'NDCG@20': '0.0406'}
2024-12-03 20:34:26,676 - EarlyStopping counter: 8 out of 10
2024-12-03 20:34:28,263 - {'epoch': 44, 'rec_loss': '6.3442'}
2024-12-03 20:34:28,553 - {'Epoch': 44, 'HR@5': '0.0422', 'NDCG@5': '0.0288', 'HR@10': '0.0697', 'NDCG@10': '0.0376', 'HR@20': '0.1064', 'NDCG@20': '0.0469'}
2024-12-03 20:34:28,553 - EarlyStopping counter: 9 out of 10
2024-12-03 20:34:30,191 - {'epoch': 45, 'rec_loss': '6.3297'}
2024-12-03 20:34:30,482 - {'Epoch': 45, 'HR@5': '0.0376', 'NDCG@5': '0.0245', 'HR@10': '0.0679', 'NDCG@10': '0.0343', 'HR@20': '0.1046', 'NDCG@20': '0.0435'}
2024-12-03 20:34:30,482 - EarlyStopping counter: 10 out of 10
2024-12-03 20:34:30,482 - Early stopping
2024-12-03 20:34:30,482 - ---------------Test Score---------------
2024-12-03 20:34:30,777 - {'Epoch': 0, 'HR@5': '0.0312', 'NDCG@5': '0.0214', 'HR@10': '0.0495', 'NDCG@10': '0.0270', 'HR@20': '0.0734', 'NDCG@20': '0.0330'}
2024-12-03 20:34:30,777 - BERT4Rec_LastFM
2024-12-03 20:34:30,777 - {'Epoch': 0, 'HR@5': '0.0312', 'NDCG@5': '0.0214', 'HR@10': '0.0495', 'NDCG@10': '0.0270', 'HR@20': '0.0734', 'NDCG@20': '0.0330'}
