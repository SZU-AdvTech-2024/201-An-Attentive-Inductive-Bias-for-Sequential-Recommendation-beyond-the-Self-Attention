2025-01-06 20:53:10,372 - Namespace(data_dir='./data/', output_dir='output/', data_name='Sports_and_Outdoors', do_eval=False, load_model=None, train_name='BSARec_A_Sports_and_Outdoors', num_items=10, num_users=35599, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='BSARec_A', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, c=5, alpha=0.7, cuda_condition=True, data_file='./data/Sports_and_Outdoors.txt', item_size=18358, checkpoint_path='output/BSARec_A_Sports_and_Outdoors.pt', same_target_path='./data/Sports_and_Outdoors_same_target.npy')
2025-01-06 20:53:10,394 - BSARecModel_A(
  (item_embeddings): Embedding(18358, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (item_encoder): BSARecEncoder(
    (blocks): ModuleList(
      (0): BSARecBlock(
        (layer): BSARecLayer(
          (filter_layer): FrequencyLayer(
            (out_dropout): Dropout(p=0.5, inplace=False)
            (LayerNorm): LayerNorm()
          )
          (attention_layer): MultiHeadAttention(
            (query): Linear(in_features=64, out_features=64, bias=True)
            (key): Linear(in_features=64, out_features=64, bias=True)
            (value): Linear(in_features=64, out_features=64, bias=True)
            (softmax): Softmax(dim=-1)
            (attn_dropout): Dropout(p=0.5, inplace=False)
            (dense): Linear(in_features=64, out_features=64, bias=True)
            (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
            (out_dropout): Dropout(p=0.5, inplace=False)
          )
        )
        (feed_forward_d): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
      (1): BSARecBlock(
        (layer): BSARecLayer(
          (filter_layer): FrequencyLayer(
            (out_dropout): Dropout(p=0.5, inplace=False)
            (LayerNorm): LayerNorm()
          )
          (attention_layer): MultiHeadAttention(
            (query): Linear(in_features=64, out_features=64, bias=True)
            (key): Linear(in_features=64, out_features=64, bias=True)
            (value): Linear(in_features=64, out_features=64, bias=True)
            (softmax): Softmax(dim=-1)
            (attn_dropout): Dropout(p=0.5, inplace=False)
            (dense): Linear(in_features=64, out_features=64, bias=True)
            (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
            (out_dropout): Dropout(p=0.5, inplace=False)
          )
        )
        (feed_forward_d): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
    )
  )
)
2025-01-06 20:53:12,951 - Total Parameters: 1278592
2025-01-06 20:54:32,137 - {'epoch': 0, 'rec_loss': '9.3883'}
2025-01-06 20:54:57,121 - {'Epoch': 0, 'HR@5': '0.0084', 'NDCG@5': '0.0055', 'HR@10': '0.0140', 'NDCG@10': '0.0072', 'HR@20': '0.0248', 'NDCG@20': '0.0100'}
2025-01-06 20:54:57,123 - Validation score increased.  Saving model ...
2025-01-06 20:56:17,522 - {'epoch': 1, 'rec_loss': '9.1417'}
2025-01-06 20:56:40,709 - {'Epoch': 1, 'HR@5': '0.0142', 'NDCG@5': '0.0089', 'HR@10': '0.0239', 'NDCG@10': '0.0120', 'HR@20': '0.0382', 'NDCG@20': '0.0156'}
2025-01-06 20:56:40,710 - Validation score increased.  Saving model ...
2025-01-06 20:57:47,779 - {'epoch': 2, 'rec_loss': '8.9032'}
2025-01-06 20:58:07,185 - {'Epoch': 2, 'HR@5': '0.0168', 'NDCG@5': '0.0108', 'HR@10': '0.0281', 'NDCG@10': '0.0144', 'HR@20': '0.0461', 'NDCG@20': '0.0189'}
2025-01-06 20:58:07,186 - Validation score increased.  Saving model ...
2025-01-06 20:59:12,631 - {'epoch': 3, 'rec_loss': '8.7446'}
2025-01-06 20:59:32,325 - {'Epoch': 3, 'HR@5': '0.0199', 'NDCG@5': '0.0125', 'HR@10': '0.0328', 'NDCG@10': '0.0166', 'HR@20': '0.0524', 'NDCG@20': '0.0216'}
2025-01-06 20:59:32,326 - Validation score increased.  Saving model ...
2025-01-06 21:00:38,821 - {'epoch': 4, 'rec_loss': '8.6188'}
2025-01-06 21:00:58,119 - {'Epoch': 4, 'HR@5': '0.0244', 'NDCG@5': '0.0161', 'HR@10': '0.0395', 'NDCG@10': '0.0209', 'HR@20': '0.0606', 'NDCG@20': '0.0262'}
2025-01-06 21:00:58,119 - Validation score increased.  Saving model ...
2025-01-06 21:02:03,741 - {'epoch': 5, 'rec_loss': '8.4968'}
2025-01-06 21:02:23,748 - {'Epoch': 5, 'HR@5': '0.0296', 'NDCG@5': '0.0194', 'HR@10': '0.0452', 'NDCG@10': '0.0245', 'HR@20': '0.0693', 'NDCG@20': '0.0306'}
2025-01-06 21:02:23,751 - Validation score increased.  Saving model ...
2025-01-06 21:03:25,682 - {'epoch': 6, 'rec_loss': '8.3816'}
2025-01-06 21:03:43,751 - {'Epoch': 6, 'HR@5': '0.0346', 'NDCG@5': '0.0232', 'HR@10': '0.0506', 'NDCG@10': '0.0283', 'HR@20': '0.0751', 'NDCG@20': '0.0345'}
2025-01-06 21:03:43,753 - Validation score increased.  Saving model ...
2025-01-06 21:04:40,608 - {'epoch': 7, 'rec_loss': '8.2723'}
2025-01-06 21:04:58,657 - {'Epoch': 7, 'HR@5': '0.0396', 'NDCG@5': '0.0268', 'HR@10': '0.0573', 'NDCG@10': '0.0325', 'HR@20': '0.0838', 'NDCG@20': '0.0391'}
2025-01-06 21:04:58,658 - Validation score increased.  Saving model ...
2025-01-06 21:05:54,535 - {'epoch': 8, 'rec_loss': '8.1677'}
2025-01-06 21:06:13,121 - {'Epoch': 8, 'HR@5': '0.0399', 'NDCG@5': '0.0275', 'HR@10': '0.0599', 'NDCG@10': '0.0339', 'HR@20': '0.0859', 'NDCG@20': '0.0404'}
2025-01-06 21:06:13,123 - Validation score increased.  Saving model ...
2025-01-06 21:06:59,900 - {'epoch': 9, 'rec_loss': '8.0796'}
2025-01-06 21:07:14,792 - {'Epoch': 9, 'HR@5': '0.0428', 'NDCG@5': '0.0296', 'HR@10': '0.0629', 'NDCG@10': '0.0361', 'HR@20': '0.0906', 'NDCG@20': '0.0431'}
2025-01-06 21:07:14,794 - Validation score increased.  Saving model ...
2025-01-06 21:07:52,010 - {'epoch': 10, 'rec_loss': '7.9961'}
2025-01-06 21:08:07,327 - {'Epoch': 10, 'HR@5': '0.0446', 'NDCG@5': '0.0311', 'HR@10': '0.0641', 'NDCG@10': '0.0374', 'HR@20': '0.0929', 'NDCG@20': '0.0447'}
2025-01-06 21:08:07,329 - Validation score increased.  Saving model ...
2025-01-06 21:09:12,987 - {'epoch': 11, 'rec_loss': '7.9204'}
2025-01-06 21:09:36,753 - {'Epoch': 11, 'HR@5': '0.0462', 'NDCG@5': '0.0324', 'HR@10': '0.0661', 'NDCG@10': '0.0388', 'HR@20': '0.0950', 'NDCG@20': '0.0461'}
2025-01-06 21:09:36,754 - Validation score increased.  Saving model ...
2025-01-06 21:10:57,091 - {'epoch': 12, 'rec_loss': '7.8582'}
2025-01-06 21:11:21,315 - {'Epoch': 12, 'HR@5': '0.0468', 'NDCG@5': '0.0331', 'HR@10': '0.0689', 'NDCG@10': '0.0402', 'HR@20': '0.0957', 'NDCG@20': '0.0469'}
2025-01-06 21:11:21,317 - Validation score increased.  Saving model ...
2025-01-06 21:12:44,335 - {'epoch': 13, 'rec_loss': '7.7988'}
2025-01-06 21:13:09,085 - {'Epoch': 13, 'HR@5': '0.0478', 'NDCG@5': '0.0338', 'HR@10': '0.0678', 'NDCG@10': '0.0402', 'HR@20': '0.0954', 'NDCG@20': '0.0472'}
2025-01-06 21:13:09,087 - Validation score increased.  Saving model ...
2025-01-06 21:14:31,138 - {'epoch': 14, 'rec_loss': '7.7496'}
2025-01-06 21:14:56,686 - {'Epoch': 14, 'HR@5': '0.0480', 'NDCG@5': '0.0337', 'HR@10': '0.0692', 'NDCG@10': '0.0405', 'HR@20': '0.0973', 'NDCG@20': '0.0476'}
2025-01-06 21:14:56,686 - Validation score increased.  Saving model ...
2025-01-06 21:16:16,237 - {'epoch': 15, 'rec_loss': '7.7094'}
2025-01-06 21:16:42,237 - {'Epoch': 15, 'HR@5': '0.0490', 'NDCG@5': '0.0342', 'HR@10': '0.0701', 'NDCG@10': '0.0411', 'HR@20': '0.0973', 'NDCG@20': '0.0479'}
2025-01-06 21:16:42,238 - Validation score increased.  Saving model ...
2025-01-06 21:18:02,139 - {'epoch': 16, 'rec_loss': '7.6687'}
2025-01-06 21:18:27,038 - {'Epoch': 16, 'HR@5': '0.0490', 'NDCG@5': '0.0343', 'HR@10': '0.0699', 'NDCG@10': '0.0410', 'HR@20': '0.0975', 'NDCG@20': '0.0480'}
2025-01-06 21:18:27,041 - Validation score increased.  Saving model ...
2025-01-06 21:19:44,029 - {'epoch': 17, 'rec_loss': '7.6380'}
2025-01-06 21:20:09,928 - {'Epoch': 17, 'HR@5': '0.0505', 'NDCG@5': '0.0350', 'HR@10': '0.0713', 'NDCG@10': '0.0417', 'HR@20': '0.0989', 'NDCG@20': '0.0486'}
2025-01-06 21:20:09,931 - Validation score increased.  Saving model ...
2025-01-06 21:21:29,001 - {'epoch': 18, 'rec_loss': '7.6094'}
2025-01-06 21:21:53,576 - {'Epoch': 18, 'HR@5': '0.0497', 'NDCG@5': '0.0347', 'HR@10': '0.0708', 'NDCG@10': '0.0415', 'HR@20': '0.0983', 'NDCG@20': '0.0484'}
2025-01-06 21:21:53,579 - EarlyStopping counter: 1 out of 10
2025-01-06 21:23:13,216 - {'epoch': 19, 'rec_loss': '7.5819'}
2025-01-06 21:23:37,347 - {'Epoch': 19, 'HR@5': '0.0499', 'NDCG@5': '0.0351', 'HR@10': '0.0704', 'NDCG@10': '0.0417', 'HR@20': '0.0991', 'NDCG@20': '0.0489'}
2025-01-06 21:23:37,350 - Validation score increased.  Saving model ...
2025-01-06 21:25:00,187 - {'epoch': 20, 'rec_loss': '7.5592'}
2025-01-06 21:25:24,310 - {'Epoch': 20, 'HR@5': '0.0496', 'NDCG@5': '0.0351', 'HR@10': '0.0712', 'NDCG@10': '0.0420', 'HR@20': '0.1001', 'NDCG@20': '0.0493'}
2025-01-06 21:25:24,313 - Validation score increased.  Saving model ...
2025-01-06 21:26:43,018 - {'epoch': 21, 'rec_loss': '7.5396'}
2025-01-06 21:27:08,106 - {'Epoch': 21, 'HR@5': '0.0491', 'NDCG@5': '0.0348', 'HR@10': '0.0707', 'NDCG@10': '0.0418', 'HR@20': '0.0998', 'NDCG@20': '0.0491'}
2025-01-06 21:27:08,106 - EarlyStopping counter: 1 out of 10
2025-01-06 21:28:24,473 - {'epoch': 22, 'rec_loss': '7.5205'}
2025-01-06 21:28:50,842 - {'Epoch': 22, 'HR@5': '0.0493', 'NDCG@5': '0.0348', 'HR@10': '0.0710', 'NDCG@10': '0.0417', 'HR@20': '0.0981', 'NDCG@20': '0.0486'}
2025-01-06 21:28:50,844 - EarlyStopping counter: 2 out of 10
2025-01-06 21:30:09,573 - {'epoch': 23, 'rec_loss': '7.4978'}
2025-01-06 21:30:34,551 - {'Epoch': 23, 'HR@5': '0.0494', 'NDCG@5': '0.0349', 'HR@10': '0.0707', 'NDCG@10': '0.0417', 'HR@20': '0.0995', 'NDCG@20': '0.0490'}
2025-01-06 21:30:34,554 - EarlyStopping counter: 3 out of 10
2025-01-06 21:31:50,852 - {'epoch': 24, 'rec_loss': '7.4845'}
2025-01-06 21:32:17,028 - {'Epoch': 24, 'HR@5': '0.0499', 'NDCG@5': '0.0351', 'HR@10': '0.0718', 'NDCG@10': '0.0422', 'HR@20': '0.1006', 'NDCG@20': '0.0494'}
2025-01-06 21:32:17,029 - Validation score increased.  Saving model ...
2025-01-06 21:33:34,976 - {'epoch': 25, 'rec_loss': '7.4694'}
2025-01-06 21:33:58,342 - {'Epoch': 25, 'HR@5': '0.0502', 'NDCG@5': '0.0347', 'HR@10': '0.0711', 'NDCG@10': '0.0414', 'HR@20': '0.0990', 'NDCG@20': '0.0485'}
2025-01-06 21:33:58,342 - EarlyStopping counter: 1 out of 10
2025-01-06 21:35:16,348 - {'epoch': 26, 'rec_loss': '7.4559'}
2025-01-06 21:35:39,988 - {'Epoch': 26, 'HR@5': '0.0496', 'NDCG@5': '0.0346', 'HR@10': '0.0703', 'NDCG@10': '0.0413', 'HR@20': '0.1008', 'NDCG@20': '0.0490'}
2025-01-06 21:35:39,989 - EarlyStopping counter: 2 out of 10
2025-01-06 21:36:56,296 - {'epoch': 27, 'rec_loss': '7.4407'}
2025-01-06 21:37:21,144 - {'Epoch': 27, 'HR@5': '0.0490', 'NDCG@5': '0.0344', 'HR@10': '0.0707', 'NDCG@10': '0.0414', 'HR@20': '0.0990', 'NDCG@20': '0.0485'}
2025-01-06 21:37:21,154 - EarlyStopping counter: 3 out of 10
2025-01-06 21:38:40,501 - {'epoch': 28, 'rec_loss': '7.4297'}
2025-01-06 21:39:05,414 - {'Epoch': 28, 'HR@5': '0.0502', 'NDCG@5': '0.0351', 'HR@10': '0.0711', 'NDCG@10': '0.0419', 'HR@20': '0.0996', 'NDCG@20': '0.0490'}
2025-01-06 21:39:05,416 - EarlyStopping counter: 4 out of 10
2025-01-06 21:40:23,915 - {'epoch': 29, 'rec_loss': '7.4182'}
2025-01-06 21:40:48,162 - {'Epoch': 29, 'HR@5': '0.0502', 'NDCG@5': '0.0354', 'HR@10': '0.0712', 'NDCG@10': '0.0422', 'HR@20': '0.0999', 'NDCG@20': '0.0494'}
2025-01-06 21:40:48,163 - EarlyStopping counter: 5 out of 10
2025-01-06 21:42:07,117 - {'epoch': 30, 'rec_loss': '7.4071'}
2025-01-06 21:42:31,860 - {'Epoch': 30, 'HR@5': '0.0497', 'NDCG@5': '0.0348', 'HR@10': '0.0710', 'NDCG@10': '0.0416', 'HR@20': '0.1009', 'NDCG@20': '0.0491'}
2025-01-06 21:42:31,863 - EarlyStopping counter: 6 out of 10
2025-01-06 21:43:47,989 - {'epoch': 31, 'rec_loss': '7.3929'}
2025-01-06 21:44:13,898 - {'Epoch': 31, 'HR@5': '0.0506', 'NDCG@5': '0.0354', 'HR@10': '0.0705', 'NDCG@10': '0.0418', 'HR@20': '0.1004', 'NDCG@20': '0.0493'}
2025-01-06 21:44:13,901 - EarlyStopping counter: 7 out of 10
2025-01-06 21:45:35,956 - {'epoch': 32, 'rec_loss': '7.3853'}
2025-01-06 21:45:59,838 - {'Epoch': 32, 'HR@5': '0.0499', 'NDCG@5': '0.0347', 'HR@10': '0.0717', 'NDCG@10': '0.0418', 'HR@20': '0.1005', 'NDCG@20': '0.0490'}
2025-01-06 21:45:59,839 - EarlyStopping counter: 8 out of 10
2025-01-06 21:47:21,978 - {'epoch': 33, 'rec_loss': '7.3737'}
2025-01-06 21:47:44,594 - {'Epoch': 33, 'HR@5': '0.0493', 'NDCG@5': '0.0346', 'HR@10': '0.0714', 'NDCG@10': '0.0418', 'HR@20': '0.1014', 'NDCG@20': '0.0493'}
2025-01-06 21:47:44,595 - EarlyStopping counter: 9 out of 10
2025-01-06 21:49:06,118 - {'epoch': 34, 'rec_loss': '7.3621'}
2025-01-06 21:49:30,578 - {'Epoch': 34, 'HR@5': '0.0497', 'NDCG@5': '0.0349', 'HR@10': '0.0710', 'NDCG@10': '0.0417', 'HR@20': '0.1006', 'NDCG@20': '0.0491'}
2025-01-06 21:49:30,581 - EarlyStopping counter: 10 out of 10
2025-01-06 21:49:30,581 - Early stopping
2025-01-06 21:49:30,581 - ---------------Test Score---------------
2025-01-06 21:49:55,031 - {'Epoch': 0, 'HR@5': '0.0420', 'NDCG@5': '0.0294', 'HR@10': '0.0589', 'NDCG@10': '0.0348', 'HR@20': '0.0832', 'NDCG@20': '0.0410'}
2025-01-06 21:49:55,032 - BSARec_A_Sports_and_Outdoors
2025-01-06 21:49:55,032 - {'Epoch': 0, 'HR@5': '0.0420', 'NDCG@5': '0.0294', 'HR@10': '0.0589', 'NDCG@10': '0.0348', 'HR@20': '0.0832', 'NDCG@20': '0.0410'}
