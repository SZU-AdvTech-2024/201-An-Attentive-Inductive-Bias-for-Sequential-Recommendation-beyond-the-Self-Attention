2024-12-03 19:19:08,438 - Namespace(data_dir='./data/', output_dir='output/', data_name='LastFM', do_eval=False, load_model=None, train_name='Caser_LastFM', num_items=10, num_users=1091, lr=0.001, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='Caser', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, nh=8, nv=4, reg_weight=0.0001, cuda_condition=True, data_file='./data/LastFM.txt', item_size=3647, checkpoint_path='output/Caser_LastFM.pt', same_target_path='./data/LastFM_same_target.npy')
2024-12-03 19:19:08,452 - CaserModel(
  (item_embeddings): Embedding(3647, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (user_embeddings): Embedding(1091, 64, padding_idx=0)
  (conv_v): Conv2d(1, 4, kernel_size=(50, 1), stride=(1, 1))
  (conv_h): ModuleList(
    (0): Conv2d(1, 8, kernel_size=(1, 64), stride=(1, 1))
    (1): Conv2d(1, 8, kernel_size=(2, 64), stride=(1, 1))
    (2): Conv2d(1, 8, kernel_size=(3, 64), stride=(1, 1))
    (3): Conv2d(1, 8, kernel_size=(4, 64), stride=(1, 1))
    (4): Conv2d(1, 8, kernel_size=(5, 64), stride=(1, 1))
    (5): Conv2d(1, 8, kernel_size=(6, 64), stride=(1, 1))
    (6): Conv2d(1, 8, kernel_size=(7, 64), stride=(1, 1))
    (7): Conv2d(1, 8, kernel_size=(8, 64), stride=(1, 1))
    (8): Conv2d(1, 8, kernel_size=(9, 64), stride=(1, 1))
    (9): Conv2d(1, 8, kernel_size=(10, 64), stride=(1, 1))
    (10): Conv2d(1, 8, kernel_size=(11, 64), stride=(1, 1))
    (11): Conv2d(1, 8, kernel_size=(12, 64), stride=(1, 1))
    (12): Conv2d(1, 8, kernel_size=(13, 64), stride=(1, 1))
    (13): Conv2d(1, 8, kernel_size=(14, 64), stride=(1, 1))
    (14): Conv2d(1, 8, kernel_size=(15, 64), stride=(1, 1))
    (15): Conv2d(1, 8, kernel_size=(16, 64), stride=(1, 1))
    (16): Conv2d(1, 8, kernel_size=(17, 64), stride=(1, 1))
    (17): Conv2d(1, 8, kernel_size=(18, 64), stride=(1, 1))
    (18): Conv2d(1, 8, kernel_size=(19, 64), stride=(1, 1))
    (19): Conv2d(1, 8, kernel_size=(20, 64), stride=(1, 1))
    (20): Conv2d(1, 8, kernel_size=(21, 64), stride=(1, 1))
    (21): Conv2d(1, 8, kernel_size=(22, 64), stride=(1, 1))
    (22): Conv2d(1, 8, kernel_size=(23, 64), stride=(1, 1))
    (23): Conv2d(1, 8, kernel_size=(24, 64), stride=(1, 1))
    (24): Conv2d(1, 8, kernel_size=(25, 64), stride=(1, 1))
    (25): Conv2d(1, 8, kernel_size=(26, 64), stride=(1, 1))
    (26): Conv2d(1, 8, kernel_size=(27, 64), stride=(1, 1))
    (27): Conv2d(1, 8, kernel_size=(28, 64), stride=(1, 1))
    (28): Conv2d(1, 8, kernel_size=(29, 64), stride=(1, 1))
    (29): Conv2d(1, 8, kernel_size=(30, 64), stride=(1, 1))
    (30): Conv2d(1, 8, kernel_size=(31, 64), stride=(1, 1))
    (31): Conv2d(1, 8, kernel_size=(32, 64), stride=(1, 1))
    (32): Conv2d(1, 8, kernel_size=(33, 64), stride=(1, 1))
    (33): Conv2d(1, 8, kernel_size=(34, 64), stride=(1, 1))
    (34): Conv2d(1, 8, kernel_size=(35, 64), stride=(1, 1))
    (35): Conv2d(1, 8, kernel_size=(36, 64), stride=(1, 1))
    (36): Conv2d(1, 8, kernel_size=(37, 64), stride=(1, 1))
    (37): Conv2d(1, 8, kernel_size=(38, 64), stride=(1, 1))
    (38): Conv2d(1, 8, kernel_size=(39, 64), stride=(1, 1))
    (39): Conv2d(1, 8, kernel_size=(40, 64), stride=(1, 1))
    (40): Conv2d(1, 8, kernel_size=(41, 64), stride=(1, 1))
    (41): Conv2d(1, 8, kernel_size=(42, 64), stride=(1, 1))
    (42): Conv2d(1, 8, kernel_size=(43, 64), stride=(1, 1))
    (43): Conv2d(1, 8, kernel_size=(44, 64), stride=(1, 1))
    (44): Conv2d(1, 8, kernel_size=(45, 64), stride=(1, 1))
    (45): Conv2d(1, 8, kernel_size=(46, 64), stride=(1, 1))
    (46): Conv2d(1, 8, kernel_size=(47, 64), stride=(1, 1))
    (47): Conv2d(1, 8, kernel_size=(48, 64), stride=(1, 1))
    (48): Conv2d(1, 8, kernel_size=(49, 64), stride=(1, 1))
    (49): Conv2d(1, 8, kernel_size=(50, 64), stride=(1, 1))
  )
  (fc1): Linear(in_features=656, out_features=64, bias=True)
  (fc2): Linear(in_features=128, out_features=64, bias=True)
  (dropout): Dropout(p=0.5, inplace=False)
  (ac_conv): ReLU()
  (ac_fc): ReLU()
)
2024-12-03 19:19:09,809 - Total Parameters: 1010140
2024-12-03 19:19:18,783 - {'epoch': 0, 'rec_loss': '1.3216'}
2024-12-03 19:19:19,150 - {'Epoch': 0, 'HR@5': '0.0257', 'NDCG@5': '0.0149', 'HR@10': '0.0394', 'NDCG@10': '0.0194', 'HR@20': '0.0468', 'NDCG@20': '0.0213'}
2024-12-03 19:19:19,151 - Validation score increased.  Saving model ...
2024-12-03 19:19:27,593 - {'epoch': 1, 'rec_loss': '1.2160'}
2024-12-03 19:19:27,975 - {'Epoch': 1, 'HR@5': '0.0128', 'NDCG@5': '0.0078', 'HR@10': '0.0294', 'NDCG@10': '0.0131', 'HR@20': '0.0569', 'NDCG@20': '0.0200'}
2024-12-03 19:19:27,976 - EarlyStopping counter: 1 out of 10
2024-12-03 19:19:36,372 - {'epoch': 2, 'rec_loss': '1.1654'}
2024-12-03 19:19:36,743 - {'Epoch': 2, 'HR@5': '0.0101', 'NDCG@5': '0.0063', 'HR@10': '0.0239', 'NDCG@10': '0.0107', 'HR@20': '0.0495', 'NDCG@20': '0.0171'}
2024-12-03 19:19:36,744 - EarlyStopping counter: 2 out of 10
2024-12-03 19:19:45,153 - {'epoch': 3, 'rec_loss': '1.1366'}
2024-12-03 19:19:45,526 - {'Epoch': 3, 'HR@5': '0.0165', 'NDCG@5': '0.0111', 'HR@10': '0.0303', 'NDCG@10': '0.0154', 'HR@20': '0.0486', 'NDCG@20': '0.0201'}
2024-12-03 19:19:45,526 - EarlyStopping counter: 3 out of 10
2024-12-03 19:19:53,923 - {'epoch': 4, 'rec_loss': '1.1071'}
2024-12-03 19:19:54,299 - {'Epoch': 4, 'HR@5': '0.0083', 'NDCG@5': '0.0046', 'HR@10': '0.0266', 'NDCG@10': '0.0106', 'HR@20': '0.0459', 'NDCG@20': '0.0155'}
2024-12-03 19:19:54,299 - EarlyStopping counter: 4 out of 10
2024-12-03 19:20:02,763 - {'epoch': 5, 'rec_loss': '1.0750'}
2024-12-03 19:20:03,133 - {'Epoch': 5, 'HR@5': '0.0165', 'NDCG@5': '0.0101', 'HR@10': '0.0284', 'NDCG@10': '0.0140', 'HR@20': '0.0514', 'NDCG@20': '0.0197'}
2024-12-03 19:20:03,134 - EarlyStopping counter: 5 out of 10
2024-12-03 19:20:11,684 - {'epoch': 6, 'rec_loss': '1.0545'}
2024-12-03 19:20:12,068 - {'Epoch': 6, 'HR@5': '0.0174', 'NDCG@5': '0.0110', 'HR@10': '0.0284', 'NDCG@10': '0.0148', 'HR@20': '0.0560', 'NDCG@20': '0.0217'}
2024-12-03 19:20:12,069 - Validation score increased.  Saving model ...
2024-12-03 19:20:20,537 - {'epoch': 7, 'rec_loss': '1.0267'}
2024-12-03 19:20:20,922 - {'Epoch': 7, 'HR@5': '0.0174', 'NDCG@5': '0.0098', 'HR@10': '0.0321', 'NDCG@10': '0.0145', 'HR@20': '0.0587', 'NDCG@20': '0.0212'}
2024-12-03 19:20:20,923 - EarlyStopping counter: 1 out of 10
2024-12-03 19:20:29,324 - {'epoch': 8, 'rec_loss': '1.0046'}
2024-12-03 19:20:29,703 - {'Epoch': 8, 'HR@5': '0.0156', 'NDCG@5': '0.0091', 'HR@10': '0.0275', 'NDCG@10': '0.0131', 'HR@20': '0.0514', 'NDCG@20': '0.0192'}
2024-12-03 19:20:29,704 - EarlyStopping counter: 2 out of 10
2024-12-03 19:20:38,179 - {'epoch': 9, 'rec_loss': '0.9816'}
2024-12-03 19:20:38,557 - {'Epoch': 9, 'HR@5': '0.0211', 'NDCG@5': '0.0123', 'HR@10': '0.0312', 'NDCG@10': '0.0155', 'HR@20': '0.0550', 'NDCG@20': '0.0215'}
2024-12-03 19:20:38,557 - EarlyStopping counter: 3 out of 10
2024-12-03 19:20:47,056 - {'epoch': 10, 'rec_loss': '0.9611'}
2024-12-03 19:20:47,442 - {'Epoch': 10, 'HR@5': '0.0128', 'NDCG@5': '0.0077', 'HR@10': '0.0349', 'NDCG@10': '0.0150', 'HR@20': '0.0624', 'NDCG@20': '0.0219'}
2024-12-03 19:20:47,442 - Validation score increased.  Saving model ...
2024-12-03 19:20:55,997 - {'epoch': 11, 'rec_loss': '0.9337'}
2024-12-03 19:20:56,377 - {'Epoch': 11, 'HR@5': '0.0229', 'NDCG@5': '0.0130', 'HR@10': '0.0349', 'NDCG@10': '0.0169', 'HR@20': '0.0642', 'NDCG@20': '0.0242'}
2024-12-03 19:20:56,377 - Validation score increased.  Saving model ...
2024-12-03 19:21:04,912 - {'epoch': 12, 'rec_loss': '0.9082'}
2024-12-03 19:21:05,296 - {'Epoch': 12, 'HR@5': '0.0239', 'NDCG@5': '0.0158', 'HR@10': '0.0495', 'NDCG@10': '0.0239', 'HR@20': '0.0716', 'NDCG@20': '0.0294'}
2024-12-03 19:21:05,296 - Validation score increased.  Saving model ...
2024-12-03 19:21:13,782 - {'epoch': 13, 'rec_loss': '0.8934'}
2024-12-03 19:21:14,160 - {'Epoch': 13, 'HR@5': '0.0183', 'NDCG@5': '0.0115', 'HR@10': '0.0321', 'NDCG@10': '0.0159', 'HR@20': '0.0661', 'NDCG@20': '0.0245'}
2024-12-03 19:21:14,161 - EarlyStopping counter: 1 out of 10
2024-12-03 19:21:22,654 - {'epoch': 14, 'rec_loss': '0.8649'}
2024-12-03 19:21:23,034 - {'Epoch': 14, 'HR@5': '0.0229', 'NDCG@5': '0.0155', 'HR@10': '0.0404', 'NDCG@10': '0.0211', 'HR@20': '0.0651', 'NDCG@20': '0.0273'}
2024-12-03 19:21:23,035 - EarlyStopping counter: 2 out of 10
2024-12-03 19:21:31,569 - {'epoch': 15, 'rec_loss': '0.8430'}
2024-12-03 19:21:31,951 - {'Epoch': 15, 'HR@5': '0.0312', 'NDCG@5': '0.0191', 'HR@10': '0.0440', 'NDCG@10': '0.0233', 'HR@20': '0.0743', 'NDCG@20': '0.0307'}
2024-12-03 19:21:31,952 - Validation score increased.  Saving model ...
2024-12-03 19:21:40,601 - {'epoch': 16, 'rec_loss': '0.8243'}
2024-12-03 19:21:40,983 - {'Epoch': 16, 'HR@5': '0.0257', 'NDCG@5': '0.0155', 'HR@10': '0.0468', 'NDCG@10': '0.0222', 'HR@20': '0.0697', 'NDCG@20': '0.0280'}
2024-12-03 19:21:40,984 - EarlyStopping counter: 1 out of 10
2024-12-03 19:21:49,629 - {'epoch': 17, 'rec_loss': '0.7996'}
2024-12-03 19:21:50,013 - {'Epoch': 17, 'HR@5': '0.0266', 'NDCG@5': '0.0160', 'HR@10': '0.0459', 'NDCG@10': '0.0222', 'HR@20': '0.0697', 'NDCG@20': '0.0282'}
2024-12-03 19:21:50,014 - EarlyStopping counter: 2 out of 10
2024-12-03 19:21:58,557 - {'epoch': 18, 'rec_loss': '0.7907'}
2024-12-03 19:21:58,950 - {'Epoch': 18, 'HR@5': '0.0266', 'NDCG@5': '0.0174', 'HR@10': '0.0532', 'NDCG@10': '0.0258', 'HR@20': '0.0789', 'NDCG@20': '0.0323'}
2024-12-03 19:21:58,951 - Validation score increased.  Saving model ...
2024-12-03 19:22:07,596 - {'epoch': 19, 'rec_loss': '0.7714'}
2024-12-03 19:22:07,985 - {'Epoch': 19, 'HR@5': '0.0275', 'NDCG@5': '0.0189', 'HR@10': '0.0450', 'NDCG@10': '0.0245', 'HR@20': '0.0798', 'NDCG@20': '0.0334'}
2024-12-03 19:22:07,986 - Validation score increased.  Saving model ...
2024-12-03 19:22:16,603 - {'epoch': 20, 'rec_loss': '0.7508'}
2024-12-03 19:22:17,004 - {'Epoch': 20, 'HR@5': '0.0312', 'NDCG@5': '0.0206', 'HR@10': '0.0477', 'NDCG@10': '0.0259', 'HR@20': '0.0725', 'NDCG@20': '0.0321'}
2024-12-03 19:22:17,005 - EarlyStopping counter: 1 out of 10
2024-12-03 19:22:25,571 - {'epoch': 21, 'rec_loss': '0.7372'}
2024-12-03 19:22:25,962 - {'Epoch': 21, 'HR@5': '0.0413', 'NDCG@5': '0.0259', 'HR@10': '0.0550', 'NDCG@10': '0.0302', 'HR@20': '0.0752', 'NDCG@20': '0.0351'}
2024-12-03 19:22:25,963 - Validation score increased.  Saving model ...
2024-12-03 19:22:34,568 - {'epoch': 22, 'rec_loss': '0.7189'}
2024-12-03 19:22:34,949 - {'Epoch': 22, 'HR@5': '0.0330', 'NDCG@5': '0.0249', 'HR@10': '0.0486', 'NDCG@10': '0.0299', 'HR@20': '0.0688', 'NDCG@20': '0.0349'}
2024-12-03 19:22:34,950 - EarlyStopping counter: 1 out of 10
2024-12-03 19:22:43,435 - {'epoch': 23, 'rec_loss': '0.7043'}
2024-12-03 19:22:43,807 - {'Epoch': 23, 'HR@5': '0.0321', 'NDCG@5': '0.0207', 'HR@10': '0.0477', 'NDCG@10': '0.0257', 'HR@20': '0.0725', 'NDCG@20': '0.0320'}
2024-12-03 19:22:43,808 - EarlyStopping counter: 2 out of 10
2024-12-03 19:22:52,340 - {'epoch': 24, 'rec_loss': '0.6984'}
2024-12-03 19:22:52,722 - {'Epoch': 24, 'HR@5': '0.0257', 'NDCG@5': '0.0184', 'HR@10': '0.0440', 'NDCG@10': '0.0243', 'HR@20': '0.0716', 'NDCG@20': '0.0313'}
2024-12-03 19:22:52,722 - EarlyStopping counter: 3 out of 10
2024-12-03 19:23:01,337 - {'epoch': 25, 'rec_loss': '0.6750'}
2024-12-03 19:23:01,724 - {'Epoch': 25, 'HR@5': '0.0294', 'NDCG@5': '0.0207', 'HR@10': '0.0422', 'NDCG@10': '0.0249', 'HR@20': '0.0651', 'NDCG@20': '0.0306'}
2024-12-03 19:23:01,725 - EarlyStopping counter: 4 out of 10
2024-12-03 19:23:10,262 - {'epoch': 26, 'rec_loss': '0.6699'}
2024-12-03 19:23:10,642 - {'Epoch': 26, 'HR@5': '0.0257', 'NDCG@5': '0.0188', 'HR@10': '0.0422', 'NDCG@10': '0.0241', 'HR@20': '0.0697', 'NDCG@20': '0.0310'}
2024-12-03 19:23:10,643 - EarlyStopping counter: 5 out of 10
2024-12-03 19:23:19,218 - {'epoch': 27, 'rec_loss': '0.6676'}
2024-12-03 19:23:19,607 - {'Epoch': 27, 'HR@5': '0.0202', 'NDCG@5': '0.0145', 'HR@10': '0.0367', 'NDCG@10': '0.0199', 'HR@20': '0.0615', 'NDCG@20': '0.0262'}
2024-12-03 19:23:19,608 - EarlyStopping counter: 6 out of 10
2024-12-03 19:23:28,190 - {'epoch': 28, 'rec_loss': '0.6448'}
2024-12-03 19:23:28,568 - {'Epoch': 28, 'HR@5': '0.0284', 'NDCG@5': '0.0186', 'HR@10': '0.0422', 'NDCG@10': '0.0229', 'HR@20': '0.0661', 'NDCG@20': '0.0288'}
2024-12-03 19:23:28,569 - EarlyStopping counter: 7 out of 10
2024-12-03 19:23:37,156 - {'epoch': 29, 'rec_loss': '0.6307'}
2024-12-03 19:23:37,534 - {'Epoch': 29, 'HR@5': '0.0174', 'NDCG@5': '0.0116', 'HR@10': '0.0358', 'NDCG@10': '0.0174', 'HR@20': '0.0587', 'NDCG@20': '0.0230'}
2024-12-03 19:23:37,535 - EarlyStopping counter: 8 out of 10
2024-12-03 19:23:46,139 - {'epoch': 30, 'rec_loss': '0.6208'}
2024-12-03 19:23:46,520 - {'Epoch': 30, 'HR@5': '0.0248', 'NDCG@5': '0.0160', 'HR@10': '0.0358', 'NDCG@10': '0.0195', 'HR@20': '0.0651', 'NDCG@20': '0.0268'}
2024-12-03 19:23:46,521 - EarlyStopping counter: 9 out of 10
2024-12-03 19:23:55,021 - {'epoch': 31, 'rec_loss': '0.6196'}
2024-12-03 19:23:55,409 - {'Epoch': 31, 'HR@5': '0.0266', 'NDCG@5': '0.0163', 'HR@10': '0.0422', 'NDCG@10': '0.0213', 'HR@20': '0.0688', 'NDCG@20': '0.0280'}
2024-12-03 19:23:55,409 - EarlyStopping counter: 10 out of 10
2024-12-03 19:23:55,409 - Early stopping
2024-12-03 19:23:55,410 - ---------------Test Score---------------
2024-12-03 19:23:55,788 - {'Epoch': 0, 'HR@5': '0.0404', 'NDCG@5': '0.0277', 'HR@10': '0.0495', 'NDCG@10': '0.0307', 'HR@20': '0.0651', 'NDCG@20': '0.0346'}
2024-12-03 19:23:55,789 - Caser_LastFM
2024-12-03 19:23:55,789 - {'Epoch': 0, 'HR@5': '0.0404', 'NDCG@5': '0.0277', 'HR@10': '0.0495', 'NDCG@10': '0.0307', 'HR@20': '0.0651', 'NDCG@20': '0.0346'}
