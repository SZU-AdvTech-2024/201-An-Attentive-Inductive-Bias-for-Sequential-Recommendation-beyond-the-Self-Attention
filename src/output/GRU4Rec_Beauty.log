2024-12-03 13:21:12,613 - Namespace(data_dir='./data/', output_dir='output/', data_name='Beauty', do_eval=False, load_model=None, train_name='GRU4Rec_Beauty', num_items=10, num_users=22364, lr=0.001, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='GRU4Rec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, gru_hidden_size=64, cuda_condition=True, data_file='./data/Beauty.txt', item_size=12102, checkpoint_path='output/GRU4Rec_Beauty.pt', same_target_path='./data/Beauty_same_target.npy')
2024-12-03 13:21:12,622 - GRU4RecModel(
  (item_embeddings): Embedding(12102, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (emb_dropout): Dropout(p=0.5, inplace=False)
  (gru_layers): GRU(64, 64, num_layers=2, bias=False, batch_first=True)
  (dense): Linear(in_features=64, out_features=64, bias=True)
)
2024-12-03 13:21:14,359 - Total Parameters: 831040
2024-12-03 13:21:17,178 - {'epoch': 0, 'rec_loss': '0.5595'}
2024-12-03 13:21:20,192 - {'Epoch': 0, 'HR@5': '0.0080', 'NDCG@5': '0.0041', 'HR@10': '0.0128', 'NDCG@10': '0.0057', 'HR@20': '0.0240', 'NDCG@20': '0.0085'}
2024-12-03 13:21:20,192 - Validation score increased.  Saving model ...
2024-12-03 13:21:22,577 - {'epoch': 1, 'rec_loss': '0.4980'}
2024-12-03 13:21:26,175 - {'Epoch': 1, 'HR@5': '0.0108', 'NDCG@5': '0.0069', 'HR@10': '0.0196', 'NDCG@10': '0.0098', 'HR@20': '0.0305', 'NDCG@20': '0.0125'}
2024-12-03 13:21:26,175 - Validation score increased.  Saving model ...
2024-12-03 13:21:28,595 - {'epoch': 2, 'rec_loss': '0.4614'}
2024-12-03 13:21:32,514 - {'Epoch': 2, 'HR@5': '0.0109', 'NDCG@5': '0.0068', 'HR@10': '0.0192', 'NDCG@10': '0.0094', 'HR@20': '0.0312', 'NDCG@20': '0.0124'}
2024-12-03 13:21:32,514 - EarlyStopping counter: 1 out of 10
2024-12-03 13:21:34,911 - {'epoch': 3, 'rec_loss': '0.4368'}
2024-12-03 13:21:38,911 - {'Epoch': 3, 'HR@5': '0.0106', 'NDCG@5': '0.0070', 'HR@10': '0.0181', 'NDCG@10': '0.0094', 'HR@20': '0.0307', 'NDCG@20': '0.0126'}
2024-12-03 13:21:38,911 - Validation score increased.  Saving model ...
2024-12-03 13:21:41,425 - {'epoch': 4, 'rec_loss': '0.4204'}
2024-12-03 13:21:45,319 - {'Epoch': 4, 'HR@5': '0.0127', 'NDCG@5': '0.0083', 'HR@10': '0.0214', 'NDCG@10': '0.0112', 'HR@20': '0.0341', 'NDCG@20': '0.0143'}
2024-12-03 13:21:45,320 - Validation score increased.  Saving model ...
2024-12-03 13:21:47,815 - {'epoch': 5, 'rec_loss': '0.4050'}
2024-12-03 13:21:51,742 - {'Epoch': 5, 'HR@5': '0.0127', 'NDCG@5': '0.0083', 'HR@10': '0.0191', 'NDCG@10': '0.0104', 'HR@20': '0.0309', 'NDCG@20': '0.0133'}
2024-12-03 13:21:51,744 - EarlyStopping counter: 1 out of 10
2024-12-03 13:21:54,323 - {'epoch': 6, 'rec_loss': '0.3916'}
2024-12-03 13:21:58,206 - {'Epoch': 6, 'HR@5': '0.0129', 'NDCG@5': '0.0080', 'HR@10': '0.0207', 'NDCG@10': '0.0105', 'HR@20': '0.0326', 'NDCG@20': '0.0135'}
2024-12-03 13:21:58,206 - EarlyStopping counter: 2 out of 10
2024-12-03 13:22:01,026 - {'epoch': 7, 'rec_loss': '0.3817'}
2024-12-03 13:22:04,683 - {'Epoch': 7, 'HR@5': '0.0120', 'NDCG@5': '0.0071', 'HR@10': '0.0223', 'NDCG@10': '0.0104', 'HR@20': '0.0356', 'NDCG@20': '0.0138'}
2024-12-03 13:22:04,683 - EarlyStopping counter: 3 out of 10
2024-12-03 13:22:07,476 - {'epoch': 8, 'rec_loss': '0.3703'}
2024-12-03 13:22:11,324 - {'Epoch': 8, 'HR@5': '0.0146', 'NDCG@5': '0.0091', 'HR@10': '0.0237', 'NDCG@10': '0.0120', 'HR@20': '0.0362', 'NDCG@20': '0.0152'}
2024-12-03 13:22:11,325 - Validation score increased.  Saving model ...
2024-12-03 13:22:14,165 - {'epoch': 9, 'rec_loss': '0.3599'}
2024-12-03 13:22:17,993 - {'Epoch': 9, 'HR@5': '0.0122', 'NDCG@5': '0.0075', 'HR@10': '0.0228', 'NDCG@10': '0.0108', 'HR@20': '0.0376', 'NDCG@20': '0.0146'}
2024-12-03 13:22:17,993 - EarlyStopping counter: 1 out of 10
2024-12-03 13:22:20,560 - {'epoch': 10, 'rec_loss': '0.3483'}
2024-12-03 13:22:24,161 - {'Epoch': 10, 'HR@5': '0.0115', 'NDCG@5': '0.0075', 'HR@10': '0.0220', 'NDCG@10': '0.0108', 'HR@20': '0.0369', 'NDCG@20': '0.0146'}
2024-12-03 13:22:24,162 - EarlyStopping counter: 2 out of 10
2024-12-03 13:22:26,879 - {'epoch': 11, 'rec_loss': '0.3365'}
2024-12-03 13:22:30,442 - {'Epoch': 11, 'HR@5': '0.0129', 'NDCG@5': '0.0078', 'HR@10': '0.0219', 'NDCG@10': '0.0107', 'HR@20': '0.0378', 'NDCG@20': '0.0147'}
2024-12-03 13:22:30,443 - EarlyStopping counter: 3 out of 10
2024-12-03 13:22:33,118 - {'epoch': 12, 'rec_loss': '0.3243'}
2024-12-03 13:22:36,732 - {'Epoch': 12, 'HR@5': '0.0126', 'NDCG@5': '0.0075', 'HR@10': '0.0224', 'NDCG@10': '0.0107', 'HR@20': '0.0378', 'NDCG@20': '0.0145'}
2024-12-03 13:22:36,732 - EarlyStopping counter: 4 out of 10
2024-12-03 13:22:39,335 - {'epoch': 13, 'rec_loss': '0.3153'}
2024-12-03 13:22:43,006 - {'Epoch': 13, 'HR@5': '0.0122', 'NDCG@5': '0.0074', 'HR@10': '0.0207', 'NDCG@10': '0.0102', 'HR@20': '0.0379', 'NDCG@20': '0.0145'}
2024-12-03 13:22:43,006 - EarlyStopping counter: 5 out of 10
2024-12-03 13:22:45,592 - {'epoch': 14, 'rec_loss': '0.3069'}
2024-12-03 13:22:49,306 - {'Epoch': 14, 'HR@5': '0.0115', 'NDCG@5': '0.0070', 'HR@10': '0.0211', 'NDCG@10': '0.0101', 'HR@20': '0.0377', 'NDCG@20': '0.0143'}
2024-12-03 13:22:49,307 - EarlyStopping counter: 6 out of 10
2024-12-03 13:22:51,796 - {'epoch': 15, 'rec_loss': '0.2993'}
2024-12-03 13:22:55,434 - {'Epoch': 15, 'HR@5': '0.0110', 'NDCG@5': '0.0069', 'HR@10': '0.0219', 'NDCG@10': '0.0103', 'HR@20': '0.0408', 'NDCG@20': '0.0151'}
2024-12-03 13:22:55,435 - EarlyStopping counter: 7 out of 10
2024-12-03 13:22:58,091 - {'epoch': 16, 'rec_loss': '0.2921'}
2024-12-03 13:23:01,839 - {'Epoch': 16, 'HR@5': '0.0129', 'NDCG@5': '0.0080', 'HR@10': '0.0216', 'NDCG@10': '0.0108', 'HR@20': '0.0373', 'NDCG@20': '0.0147'}
2024-12-03 13:23:01,839 - EarlyStopping counter: 8 out of 10
2024-12-03 13:23:04,679 - {'epoch': 17, 'rec_loss': '0.2848'}
2024-12-03 13:23:08,452 - {'Epoch': 17, 'HR@5': '0.0131', 'NDCG@5': '0.0079', 'HR@10': '0.0244', 'NDCG@10': '0.0115', 'HR@20': '0.0414', 'NDCG@20': '0.0158'}
2024-12-03 13:23:08,452 - Validation score increased.  Saving model ...
2024-12-03 13:23:11,108 - {'epoch': 18, 'rec_loss': '0.2779'}
2024-12-03 13:23:14,840 - {'Epoch': 18, 'HR@5': '0.0135', 'NDCG@5': '0.0084', 'HR@10': '0.0245', 'NDCG@10': '0.0119', 'HR@20': '0.0420', 'NDCG@20': '0.0163'}
2024-12-03 13:23:14,840 - Validation score increased.  Saving model ...
2024-12-03 13:23:17,624 - {'epoch': 19, 'rec_loss': '0.2717'}
2024-12-03 13:23:21,500 - {'Epoch': 19, 'HR@5': '0.0148', 'NDCG@5': '0.0092', 'HR@10': '0.0272', 'NDCG@10': '0.0132', 'HR@20': '0.0456', 'NDCG@20': '0.0178'}
2024-12-03 13:23:21,501 - Validation score increased.  Saving model ...
2024-12-03 13:23:24,211 - {'epoch': 20, 'rec_loss': '0.2668'}
2024-12-03 13:23:28,015 - {'Epoch': 20, 'HR@5': '0.0149', 'NDCG@5': '0.0090', 'HR@10': '0.0278', 'NDCG@10': '0.0131', 'HR@20': '0.0470', 'NDCG@20': '0.0180'}
2024-12-03 13:23:28,015 - Validation score increased.  Saving model ...
2024-12-03 13:23:30,503 - {'epoch': 21, 'rec_loss': '0.2616'}
2024-12-03 13:23:34,338 - {'Epoch': 21, 'HR@5': '0.0166', 'NDCG@5': '0.0102', 'HR@10': '0.0291', 'NDCG@10': '0.0141', 'HR@20': '0.0496', 'NDCG@20': '0.0193'}
2024-12-03 13:23:34,338 - Validation score increased.  Saving model ...
2024-12-03 13:23:36,747 - {'epoch': 22, 'rec_loss': '0.2560'}
2024-12-03 13:23:40,548 - {'Epoch': 22, 'HR@5': '0.0159', 'NDCG@5': '0.0096', 'HR@10': '0.0294', 'NDCG@10': '0.0139', 'HR@20': '0.0515', 'NDCG@20': '0.0195'}
2024-12-03 13:23:40,548 - Validation score increased.  Saving model ...
2024-12-03 13:23:43,141 - {'epoch': 23, 'rec_loss': '0.2520'}
2024-12-03 13:23:46,903 - {'Epoch': 23, 'HR@5': '0.0172', 'NDCG@5': '0.0104', 'HR@10': '0.0310', 'NDCG@10': '0.0148', 'HR@20': '0.0546', 'NDCG@20': '0.0208'}
2024-12-03 13:23:46,904 - Validation score increased.  Saving model ...
2024-12-03 13:23:49,664 - {'epoch': 24, 'rec_loss': '0.2467'}
2024-12-03 13:23:53,377 - {'Epoch': 24, 'HR@5': '0.0179', 'NDCG@5': '0.0115', 'HR@10': '0.0315', 'NDCG@10': '0.0159', 'HR@20': '0.0528', 'NDCG@20': '0.0212'}
2024-12-03 13:23:53,377 - Validation score increased.  Saving model ...
2024-12-03 13:23:55,930 - {'epoch': 25, 'rec_loss': '0.2409'}
2024-12-03 13:23:59,599 - {'Epoch': 25, 'HR@5': '0.0174', 'NDCG@5': '0.0106', 'HR@10': '0.0324', 'NDCG@10': '0.0154', 'HR@20': '0.0529', 'NDCG@20': '0.0205'}
2024-12-03 13:23:59,599 - EarlyStopping counter: 1 out of 10
2024-12-03 13:24:02,064 - {'epoch': 26, 'rec_loss': '0.2382'}
2024-12-03 13:24:05,775 - {'Epoch': 26, 'HR@5': '0.0199', 'NDCG@5': '0.0119', 'HR@10': '0.0355', 'NDCG@10': '0.0169', 'HR@20': '0.0590', 'NDCG@20': '0.0228'}
2024-12-03 13:24:05,775 - Validation score increased.  Saving model ...
2024-12-03 13:24:08,238 - {'epoch': 27, 'rec_loss': '0.2353'}
2024-12-03 13:24:12,022 - {'Epoch': 27, 'HR@5': '0.0211', 'NDCG@5': '0.0128', 'HR@10': '0.0356', 'NDCG@10': '0.0174', 'HR@20': '0.0580', 'NDCG@20': '0.0231'}
2024-12-03 13:24:12,022 - Validation score increased.  Saving model ...
2024-12-03 13:24:14,703 - {'epoch': 28, 'rec_loss': '0.2301'}
2024-12-03 13:24:18,402 - {'Epoch': 28, 'HR@5': '0.0199', 'NDCG@5': '0.0125', 'HR@10': '0.0325', 'NDCG@10': '0.0165', 'HR@20': '0.0548', 'NDCG@20': '0.0221'}
2024-12-03 13:24:18,402 - EarlyStopping counter: 1 out of 10
2024-12-03 13:24:20,795 - {'epoch': 29, 'rec_loss': '0.2292'}
2024-12-03 13:24:24,475 - {'Epoch': 29, 'HR@5': '0.0199', 'NDCG@5': '0.0125', 'HR@10': '0.0334', 'NDCG@10': '0.0168', 'HR@20': '0.0550', 'NDCG@20': '0.0222'}
2024-12-03 13:24:24,475 - EarlyStopping counter: 2 out of 10
2024-12-03 13:24:27,132 - {'epoch': 30, 'rec_loss': '0.2267'}
2024-12-03 13:24:30,866 - {'Epoch': 30, 'HR@5': '0.0230', 'NDCG@5': '0.0137', 'HR@10': '0.0366', 'NDCG@10': '0.0181', 'HR@20': '0.0593', 'NDCG@20': '0.0238'}
2024-12-03 13:24:30,866 - Validation score increased.  Saving model ...
2024-12-03 13:24:33,284 - {'epoch': 31, 'rec_loss': '0.2228'}
2024-12-03 13:24:36,964 - {'Epoch': 31, 'HR@5': '0.0196', 'NDCG@5': '0.0121', 'HR@10': '0.0365', 'NDCG@10': '0.0175', 'HR@20': '0.0583', 'NDCG@20': '0.0229'}
2024-12-03 13:24:36,964 - EarlyStopping counter: 1 out of 10
2024-12-03 13:24:39,659 - {'epoch': 32, 'rec_loss': '0.2195'}
2024-12-03 13:24:43,457 - {'Epoch': 32, 'HR@5': '0.0183', 'NDCG@5': '0.0111', 'HR@10': '0.0343', 'NDCG@10': '0.0162', 'HR@20': '0.0563', 'NDCG@20': '0.0217'}
2024-12-03 13:24:43,458 - EarlyStopping counter: 2 out of 10
2024-12-03 13:24:45,913 - {'epoch': 33, 'rec_loss': '0.2164'}
2024-12-03 13:24:49,702 - {'Epoch': 33, 'HR@5': '0.0201', 'NDCG@5': '0.0119', 'HR@10': '0.0344', 'NDCG@10': '0.0165', 'HR@20': '0.0569', 'NDCG@20': '0.0221'}
2024-12-03 13:24:49,702 - EarlyStopping counter: 3 out of 10
2024-12-03 13:24:52,241 - {'epoch': 34, 'rec_loss': '0.2135'}
2024-12-03 13:24:56,079 - {'Epoch': 34, 'HR@5': '0.0201', 'NDCG@5': '0.0119', 'HR@10': '0.0368', 'NDCG@10': '0.0173', 'HR@20': '0.0605', 'NDCG@20': '0.0232'}
2024-12-03 13:24:56,080 - EarlyStopping counter: 4 out of 10
2024-12-03 13:24:58,576 - {'epoch': 35, 'rec_loss': '0.2134'}
2024-12-03 13:25:02,378 - {'Epoch': 35, 'HR@5': '0.0198', 'NDCG@5': '0.0125', 'HR@10': '0.0358', 'NDCG@10': '0.0176', 'HR@20': '0.0586', 'NDCG@20': '0.0233'}
2024-12-03 13:25:02,378 - EarlyStopping counter: 5 out of 10
2024-12-03 13:25:04,801 - {'epoch': 36, 'rec_loss': '0.2105'}
2024-12-03 13:25:08,649 - {'Epoch': 36, 'HR@5': '0.0227', 'NDCG@5': '0.0143', 'HR@10': '0.0391', 'NDCG@10': '0.0195', 'HR@20': '0.0650', 'NDCG@20': '0.0260'}
2024-12-03 13:25:08,649 - Validation score increased.  Saving model ...
2024-12-03 13:25:11,274 - {'epoch': 37, 'rec_loss': '0.2064'}
2024-12-03 13:25:15,164 - {'Epoch': 37, 'HR@5': '0.0186', 'NDCG@5': '0.0113', 'HR@10': '0.0324', 'NDCG@10': '0.0157', 'HR@20': '0.0573', 'NDCG@20': '0.0220'}
2024-12-03 13:25:15,164 - EarlyStopping counter: 1 out of 10
2024-12-03 13:25:17,674 - {'epoch': 38, 'rec_loss': '0.2044'}
2024-12-03 13:25:21,464 - {'Epoch': 38, 'HR@5': '0.0182', 'NDCG@5': '0.0112', 'HR@10': '0.0330', 'NDCG@10': '0.0160', 'HR@20': '0.0530', 'NDCG@20': '0.0210'}
2024-12-03 13:25:21,464 - EarlyStopping counter: 2 out of 10
2024-12-03 13:25:24,088 - {'epoch': 39, 'rec_loss': '0.2024'}
2024-12-03 13:25:27,957 - {'Epoch': 39, 'HR@5': '0.0194', 'NDCG@5': '0.0120', 'HR@10': '0.0338', 'NDCG@10': '0.0167', 'HR@20': '0.0559', 'NDCG@20': '0.0222'}
2024-12-03 13:25:27,957 - EarlyStopping counter: 3 out of 10
2024-12-03 13:25:30,336 - {'epoch': 40, 'rec_loss': '0.2016'}
2024-12-03 13:25:34,142 - {'Epoch': 40, 'HR@5': '0.0210', 'NDCG@5': '0.0126', 'HR@10': '0.0346', 'NDCG@10': '0.0170', 'HR@20': '0.0597', 'NDCG@20': '0.0233'}
2024-12-03 13:25:34,142 - EarlyStopping counter: 4 out of 10
2024-12-03 13:25:36,570 - {'epoch': 41, 'rec_loss': '0.1998'}
2024-12-03 13:25:40,366 - {'Epoch': 41, 'HR@5': '0.0178', 'NDCG@5': '0.0110', 'HR@10': '0.0338', 'NDCG@10': '0.0162', 'HR@20': '0.0569', 'NDCG@20': '0.0220'}
2024-12-03 13:25:40,367 - EarlyStopping counter: 5 out of 10
2024-12-03 13:25:42,896 - {'epoch': 42, 'rec_loss': '0.1992'}
2024-12-03 13:25:46,699 - {'Epoch': 42, 'HR@5': '0.0209', 'NDCG@5': '0.0126', 'HR@10': '0.0374', 'NDCG@10': '0.0179', 'HR@20': '0.0592', 'NDCG@20': '0.0234'}
2024-12-03 13:25:46,699 - EarlyStopping counter: 6 out of 10
2024-12-03 13:25:49,354 - {'epoch': 43, 'rec_loss': '0.1966'}
2024-12-03 13:25:53,163 - {'Epoch': 43, 'HR@5': '0.0197', 'NDCG@5': '0.0120', 'HR@10': '0.0345', 'NDCG@10': '0.0168', 'HR@20': '0.0567', 'NDCG@20': '0.0223'}
2024-12-03 13:25:53,163 - EarlyStopping counter: 7 out of 10
2024-12-03 13:25:55,511 - {'epoch': 44, 'rec_loss': '0.1948'}
2024-12-03 13:25:59,284 - {'Epoch': 44, 'HR@5': '0.0213', 'NDCG@5': '0.0137', 'HR@10': '0.0349', 'NDCG@10': '0.0180', 'HR@20': '0.0570', 'NDCG@20': '0.0235'}
2024-12-03 13:25:59,285 - EarlyStopping counter: 8 out of 10
2024-12-03 13:26:01,770 - {'epoch': 45, 'rec_loss': '0.1928'}
2024-12-03 13:26:05,510 - {'Epoch': 45, 'HR@5': '0.0224', 'NDCG@5': '0.0141', 'HR@10': '0.0380', 'NDCG@10': '0.0191', 'HR@20': '0.0602', 'NDCG@20': '0.0247'}
2024-12-03 13:26:05,510 - EarlyStopping counter: 9 out of 10
2024-12-03 13:26:08,031 - {'epoch': 46, 'rec_loss': '0.1907'}
2024-12-03 13:26:11,798 - {'Epoch': 46, 'HR@5': '0.0209', 'NDCG@5': '0.0131', 'HR@10': '0.0368', 'NDCG@10': '0.0182', 'HR@20': '0.0593', 'NDCG@20': '0.0239'}
2024-12-03 13:26:11,798 - EarlyStopping counter: 10 out of 10
2024-12-03 13:26:11,798 - Early stopping
2024-12-03 13:26:11,798 - ---------------Test Score---------------
2024-12-03 13:26:15,593 - {'Epoch': 0, 'HR@5': '0.0178', 'NDCG@5': '0.0115', 'HR@10': '0.0313', 'NDCG@10': '0.0158', 'HR@20': '0.0497', 'NDCG@20': '0.0204'}
2024-12-03 13:26:15,594 - GRU4Rec_Beauty
2024-12-03 13:26:15,594 - {'Epoch': 0, 'HR@5': '0.0178', 'NDCG@5': '0.0115', 'HR@10': '0.0313', 'NDCG@10': '0.0158', 'HR@20': '0.0497', 'NDCG@20': '0.0204'}
