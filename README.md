# 基于注意力归纳偏差的自注意力顺序推荐

## 摘要

推荐系统在现代互联网服务中扮演着至关重要的角色，广泛应用于电商、流媒体、社 交网络等领域。顺序推荐（SR）作为推荐系统的一种重要形式，旨在通过分析用户的历史 交互数据预测其下一步可能的行为。近年来，Transformer 模型因其自注意力机制在捕捉 序列间长距离依赖性方面的优势，成为SR领域的主流技术。然而，现有Transformer模 型存在“过度平滑”问题，容易忽略序列中的高频细节模式，削弱了对用户短期兴趣的捕 捉能力；此外，缺乏显式的归纳偏差（Inductive Bias），导致泛化能力不足。为了解决上 述问题，研究学者提出了一种新颖的SR模型——BSARec。该模型通过引入傅里叶变换， 将频域信息融入到模型中，显著增强了对用户行为模式的建模能力。具体而言，BSARec 结合了高通滤波与低通滤波，能够同时捕捉用户的短期兴趣和长期偏好，并通过设计频率 重定标器解决了传统Transformer 模型中自注意力机制的“过度平滑”问题，提高了模型 的泛化能力和准确性。基于BSARec模型的成功经验，本文进一步提出了一种创新的顺序 推荐FBSARec 模型。FBSARec 在 BSARec 的基础上，引入了超越自注意力交叉融合模 块，显著提升了对原始数据特征的提取能力。具体而言，FBSARec不仅继承了BSARec 的优点，还通过将傅里叶变换引入到自注意力机制中，实现了频域信息的有效融入，从而 增强了对用户行为模式的建模能力。结合高通滤波与低通滤波，FBSARec能够更全面地 捕捉用户的短期兴趣和长期偏好，提供更准确的兴趣表示。实验结果表明，单独使用归纳 偏置注意力融合自注意力提取的特征表示的模型性能效果最佳。消融实验显示，归纳偏置 注意力在特征表示中发挥了关键作用。然而，多次实验也揭示了超越自注意力交叉融合模 块对模型的改进效果有限，提示未来研究可以集中在优化这一模块的设计，以进一步提升 模型的整体性能。未来的工作将继续探索如何更好地整合频域信息和自注意力机制，以期 进一步提高顺序推荐系统的性能和泛化能力。此外，还将考虑多模态数据融合、动态偏好 建模、解释性增强以及大规模数据集测试等方向，以全面提高推荐系统的实用性和鲁棒性。

## 虚拟环境创建和依赖安装

```
conda env create -f bsarec_env.yaml
conda activate bsarec
```

## 数据集

各类数据集已处理好，放于 `FBSARec\src\data` 目录下。

## 训练

输入类似以下命令来训练模型，详情可看 `try_test.txt` 文件：

```
python main.py  --model_type BSARec_S_A \
                --data_name Beauty \
                --lr 0.0005 \
                --alpha 0.7 \
                --c 5 \
                --num_attention_heads 1 \
                --train_name BSARec_S_A_Beauty
```

## 评估

输入以下命令来评估模型：

```
python main.py  --model_type BSARec_S_A \
				--data_name Beauty \
                --alpha 0.7 \
                --c 5 \
                --num_attention_heads 1 \
                --load_model BSARec_S_A_Beauty \
                --do_eval
```

